[gd_scene load_steps=14 format=2]

[ext_resource path="res://Scenes/characters/Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://Portal_Inimigos.png" type="Texture" id=2]
[ext_resource path="res://Scenes/props/Poder_Recarga.tscn" type="PackedScene" id=3]
[ext_resource path="res://icon.png" type="Texture" id=4]
[ext_resource path="res://wall.tres" type="TileSet" id=5]
[ext_resource path="res://Scenes/characters/Enemy_Base.tscn" type="PackedScene" id=6]
[ext_resource path="res://Assets/textures/Enemy2/Wraith_012.png" type="Texture" id=7]
[ext_resource path="res://Scenes/props/Poder_Dano.tscn" type="PackedScene" id=8]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

var rgn = RandomNumberGenerator.new()

var boss = preload(\"res://Scenes/characters/Enemies/Boss.tscn\")
export(Array, PackedScene) var inimigos
export(Array, PackedScene) var poderes 
#garantir que o tiro sÃ³ va existir quando existir o jogador
func _ready():
	Global.criacao_no_pai = self
	Global.pontos = 0
	
func _exit_tree():
	Global.criacao_no_pai = null

#spawnar inimigos
func _on_timer_spawn_inimigo_timeout():
	rgn.randomize()
	var portalRandom = rgn.randi_range(1, 3) 
	match portalRandom:
		1:
			var posicao_inimigo = Vector2(80,70)
			var numero_inimigos = round(rand_range(-1,inimigos.size()-1))
			Global.instance_node(inimigos[numero_inimigos], posicao_inimigo, self)
		2:
			var posicao_inimigo = Vector2(300,1100)
			var numero_inimigos = round(rand_range(-1,inimigos.size()-1))
			Global.instance_node(inimigos[numero_inimigos], posicao_inimigo, self)
		3:
			var posicao_inimigo = Vector2(1300,500)
			var numero_inimigos = round(rand_range(-1,inimigos.size()-1))
			Global.instance_node(inimigos[numero_inimigos], posicao_inimigo, self)
		
		
		
func _on_timer_dificuldade_timeout():
	if $timer_spawn_inimigo.wait_time > 0.5:
		$timer_spawn_inimigo.wait_time -= 0.1


func _on_timer_spawn_boss_timeout():
	var posicao_boss = Vector2(1300,500)
	Global.instance_node(boss, posicao_boss, self)


func _on_timer_spawn_poder_timeout():
	var posicao_poderes = Vector2(80,70)
	var numero_poderes = round(rand_range(-1,poderes.size()-1))
	Global.instance_node(poderes[numero_poderes], posicao_poderes, self)
"

[sub_resource type="GDScript" id=3]
script/source = "extends \"res://Scenes/characters/Enemy_Base.gd\"

func _physics_process(delta):
	moviemto_basico_inimigo(delta)


"

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 23.5, 17 )

[sub_resource type="RectangleShape2D" id=4]
extents = Vector2( 24, 17 )

[sub_resource type="PackedScene" id=5]
_bundled = {
"conn_count": 2,
"conns": PoolIntArray( 3, 0, 17, 16, 2, 0, 5, 0, 19, 18, 2, 0 ),
"editable_instances": [  ],
"names": PoolStringArray( "Enemy2", "script", "KinematicBody2D", "Sprite", "scale", "texture", "CollisionShape2D", "position", "shape", "enemy", "Area2D", "col", "timer_recuo", "wait_time", "one_shot", "Timer", "_on_Area2D_area_entered", "area_entered", "_on_timer_recuo_timeout", "timeout" ),
"node_count": 6,
"node_paths": [  ],
"nodes": PoolIntArray( -1, -1, 2, 0, -1, 1, 1, 0, 0, 0, 0, 3, 3, -1, 2, 4, 1, 5, 2, 0, 0, 0, 6, 6, -1, 2, 7, 3, 8, 4, 1, 9, 0, 0, 10, 10, -1, 0, 1, 9, 3, 0, 6, 11, -1, 2, 7, 5, 8, 6, 1, 9, 0, 0, 15, 12, -1, 2, 13, 7, 14, 8, 0 ),
"variants": [ SubResource( 3 ), Vector2( 0.22, 0.22 ), ExtResource( 7 ), Vector2( 1.5, -6 ), SubResource( 2 ), Vector2( 1, -6 ), SubResource( 4 ), 0.1, true ],
"version": 2
}

[node name="Fase" type="Node2D"]
script = SubResource( 1 )
inimigos = [ ExtResource( 6 ), SubResource( 5 ) ]
poderes = [ ExtResource( 3 ), ExtResource( 8 ) ]

[node name="Player" parent="." instance=ExtResource( 1 )]
position = Vector2( 600, 600 )

[node name="Sprite" type="Sprite" parent="."]
modulate = Color( 0.968627, 0.937255, 0.937255, 1 )
self_modulate = Color( 0.984314, 0.984314, 0.972549, 1 )
position = Vector2( 599.499, 639 )
scale = Vector2( 31.1719, 28.9688 )
z_index = -1
texture = ExtResource( 4 )

[node name="Portal" type="Sprite" parent="."]
position = Vector2( 93, 69 )
scale = Vector2( 0.3, 0.3 )
texture = ExtResource( 2 )

[node name="Portal2" type="Sprite" parent="."]
position = Vector2( 285, 1083 )
scale = Vector2( 0.3, 0.3 )
texture = ExtResource( 2 )

[node name="Portal3" type="Sprite" parent="."]
position = Vector2( 1267, 477 )
scale = Vector2( 0.3, 0.3 )
texture = ExtResource( 2 )

[node name="TileMap" type="TileMap" parent="."]
tile_set = ExtResource( 5 )
format = 1
tile_data = PoolIntArray( -4, 0, 0, -3, 0, 0, -2, 0, 0, -1, 0, 0, -65536, 0, 0, -65535, 0, 0, -65534, 0, 0, -65533, 0, 0, -65532, 0, 0, -65531, 0, 0, -65530, 0, 0, -65529, 0, 0, -65528, 0, 0, -65527, 0, 0, -65526, 0, 0, -65525, 0, 0, -65524, 0, 0, -65523, 0, 0, -65522, 0, 0, -65521, 0, 0, -65520, 0, 0, -65519, 0, 0, 65531, 0, 0, 18, 0, 0, 131067, 0, 0, 65554, 0, 0, 196603, 0, 0, 131090, 0, 0, 262138, 0, 0, 196626, 0, 0, 327674, 0, 0, 262151, 0, 0, 262163, 0, 0, 393210, 0, 0, 327687, 0, 0, 327700, 0, 0, 327701, 0, 0, 458746, 0, 0, 393224, 0, 0, 393225, 0, 0, 393238, 0, 0, 524282, 0, 0, 458774, 0, 0, 589818, 0, 0, 524310, 0, 0, 655354, 0, 0, 589837, 0, 0, 589846, 0, 0, 720891, 0, 0, 720892, 0, 0, 655365, 0, 0, 655373, 0, 0, 655378, 0, 0, 655382, 0, 0, 786429, 0, 0, 720901, 0, 0, 720909, 0, 0, 720914, 0, 0, 720918, 0, 0, 851966, 0, 0, 851967, 0, 0, 786437, 0, 0, 786445, 0, 0, 786450, 0, 0, 786455, 0, 0, 786456, 0, 0, 917503, 0, 0, 851973, 0, 0, 851981, 0, 0, 851986, 0, 0, 851992, 0, 0, 917504, 0, 0, 917509, 0, 0, 917515, 0, 0, 917516, 0, 0, 917522, 0, 0, 917528, 0, 0, 983040, 0, 0, 983045, 0, 0, 983058, 0, 0, 983062, 0, 0, 983063, 0, 0, 983064, 0, 0, 1114110, 0, 0, 1114111, 0, 0, 1048600, 0, 0, 1179646, 0, 0, 1114136, 0, 0, 1245181, 0, 0, 1245182, 0, 0, 1179672, 0, 0, 1310717, 0, 0, 1245208, 0, 0, 1376253, 0, 0, 1310740, 0, 0, 1310741, 0, 0, 1310742, 0, 0, 1310743, 0, 0, 1441790, 0, 0, 1441791, 0, 0, 1376256, 0, 0, 1376257, 0, 0, 1376258, 0, 0, 1376259, 0, 0, 1376260, 0, 0, 1376261, 0, 0, 1376262, 0, 0, 1376263, 0, 0, 1376264, 0, 0, 1376265, 0, 0, 1376266, 0, 0, 1376267, 0, 0, 1376268, 0, 0, 1376269, 0, 0, 1376270, 0, 0, 1376271, 0, 0, 1376272, 0, 0, 1376273, 0, 0, 1376274, 0, 0, 1376275, 0, 0 )

[node name="timer_spawn_inimigo" type="Timer" parent="."]
wait_time = 3.0
autostart = true

[node name="timer_dificuldade" type="Timer" parent="."]
autostart = true

[node name="timer_spawn_boss" type="Timer" parent="."]
wait_time = 20.0
autostart = true

[node name="timer_spawn_poder" type="Timer" parent="."]
autostart = true

[connection signal="timeout" from="timer_spawn_inimigo" to="." method="_on_timer_spawn_inimigo_timeout"]
[connection signal="timeout" from="timer_dificuldade" to="." method="_on_timer_dificuldade_timeout"]
[connection signal="timeout" from="timer_spawn_boss" to="." method="_on_timer_spawn_boss_timeout"]
[connection signal="timeout" from="timer_spawn_poder" to="." method="_on_timer_spawn_poder_timeout"]
